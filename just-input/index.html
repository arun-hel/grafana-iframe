<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBB-Tools</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <div id="">
        <h2>To teach 
            <span><input type="number" oninput="calculate_price()" min="1" id="user" value="" placeholder="150" required> </span>
            concurrent students in 
            <span><input type="number" oninput="calculate_price()" min="1" id="cls" value="" placeholder="5" required> </span>
            classes, and 
            <span><input type="number" oninput="calculate_price()" min="1" id="classperday" value="" placeholder="5" required> </span>
            classes a day, here are you estimates:</h2>
    </div>
    <div class="lists">
        <ul>
            <li>1. Compute (8 CPU Core, 16 GB RAM, 3 GHz processor): <span id="compute" disabled></span></li>
            <li>2. Storage: <span id="storage" ></span> </li>
            <li>3. Bandwidth: <span id="bandwidth" ></span> </li>
            <li id="scalelite" style="display: none;"><span>4. Scalelite server needed</span></li>
            </ul>
    </div>

<style>
    /* set underline for input field to differentiate */
    #user, #cls, #classperday{
    border-bottom: solid 1px blue !important; 
    color: rgb(33, 106, 155);
    }
    /* remove default styling for input field */
    input{
    border: none;
    overflow: auto;
    outline: none;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    text-align:center;
    }

    /* remove list style so that we can dynamically add scalelite required line */
    .lists>ul>li{
        list-style: none !important;
    }

    /* remove arrow icon in number field */
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button { 
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    margin: 0; 
}
    /* remove default styling for input field  */
    #user, #cls, #classperday {
    border: none;
    border-bottom: solid 1px blueviolet;
    overflow: auto;
    outline: none;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    font-size: 20px;
    font-weight: bold;
    resize: none; /*remove the resize handle on the bottom right*/
    min-width:2em!important;
    max-width:99.99%!important;
    transition: width 0.25s;
    text-align:center;
}
    /* prevent font size change when focused change the fontsize according to your need */
    #user, #cls, #classperday:focus{
        font-size: 20px;
        font-weight: bold;
}
/* Change placeholder color */
    ::placeholder {
        color: #999;
        opacity: 0.4; /* Firefox */
    }

    :-ms-input-placeholder { /* Internet Explorer 10-11 */
        color: #999;
    }

    ::-ms-input-placeholder { /* Microsoft Edge */
        color: #999;
    }
</style>

<!-- ====== Script fot automatic rezise of input field ====== -->
<script>
    function resizable (el, factor) {
        var int = Number(factor) ||7.7;
        function resize() {el.style.width = ((el.value.length+1) * int) + 'px'}
        var e = 'keyup,keypress,focus,blur,change'.split(',');
        for (var i in e) el.addEventListener(e[i],resize,false);
        resize();
    }
    resizable(document.getElementById('user'),20);
    resizable(document.getElementById('cls'),20);
    resizable(document.getElementById('classperday'),20);
</script>

<!-- ====== Main script Here all the calculation will happens ====== -->
<script>

    function calculate_price() {
        // Get the input from user
        var user = document.getElementById("user").value.trim()

        var cls = document.getElementById("cls").value.trim()
      
        var classperday = document.getElementById("classperday").value.trim()
 
        var video = classperday * cls * ( user- 1) * 0.25 * 3600 

        var audio = user * 0.04 * 3600

        var screen_sharing = user * 0.04 * 900 * cls
        
        var bandwidth =  video + audio + screen_sharing
       
        // Total bandwidth calclulation in GB
        bandwidth_in_gb = (bandwidth/1024) *20
   
        // calculate bbb server required for current input of user
       function calclulate_bbb_server(user){
        // if user number is multipe of 150 then simply return corresponding bbb server required   
        if (user > 150 && user%150 == 0 ){
            return  (user/150)
            }
            // if user number is not a multiple of 150 (ex:320) then add +1 to fraction i.e 320/150=2.13 
            // take only 2 and add +1 i.e bbb server required for 320 user = 2 + 1 = 3 
            else if(user > 150 && user%150 != 0 ) {
               return  Math.floor(user/150) + 1
            }
            // if users are less than 150 then return 1
            else {
                return 1
            }
       }

        // Only show positive vale in result section
        function deal_with_negative(data){
            if (data >=0) {
                return data
            }
            else{
                return 0
            }
        }
        
        // Get the storage required for recording per day
        function get_recording_storage(concurrent_class,total_class){
            return (concurrent_class * total_class * 524)/1024 *20
        }

        // checks is scalelite load balencer is required?
        function is_scalelite_needed(data){
            if (data >1){
                return "block"
            }
            else{
                return "none"
            }
        }

        // only give output id all three inputs are given
        if(user && cls && classperday){
            $('#compute').text(deal_with_negative(calclulate_bbb_server(user)))
            $('#storage').text(deal_with_negative(get_recording_storage(cls,classperday))+' GB per month')
            $('#bandwidth').text(deal_with_negative(bandwidth_in_gb) + ' GB per month')
            document.getElementById('scalelite').style.display = is_scalelite_needed(calclulate_bbb_server(user))
    }

    }
</script>
</body>
</html>
